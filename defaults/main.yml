---

#REJECT # Unix
#harden_logcheck_hours: '*'
harden_logcheck_hours: '6,18'
harden_use_rpc: false
harden_use_forwarding: false
harden_umask: '022'
#harden_umask: '027'
harden_init_aidedb: false
harden_aidedb_rotatedays: 14
harden_unix_fstab_flags: true

harden_disable_usb: true

harden_bash2syslog: true

harden_restrict_compiler: true
harden_restrict_compiler_umask: '0700'
#harden_restrict_compiler_umask: '0750'
harden_restrict_compiler_group: 'root'

## firewall rules? avoid to lock yourself
#harden_fw: false
harden_fw: true
## Note: in default config, if you switch default policy to drop, you will lose access...
#harden_fw_default: DROP
harden_fw_default: ACCEPT
harden_fw_ssh_restricted:
  - 192.168.1.0/24
  - 10.0.0.0/8
  - 1.1.1.1
harden_fw_ssh_port: 22
harden_fw_snmp_restricted:
  - 192.168.1.100
harden_fw_dnsservers:
  - 192.168.1.10
  - 192.168.1.11
  - 8.8.8.8
  - 8.8.4.4
harden_fw_smtpservers:
  - 192.168.1.20
harden_fw_smtp_port: 25
harden_fw_open_incoming:
  - { proto: 'tcp', port: 8080 }
  - { proto: 'tcp', port: 9091 }

## Apport has been found to many vulnerabilities. Same for Fedora abrt
## https://bugs.launchpad.net/ubuntu/+source/apport/+bug/1507480
## http://www.openwall.com/lists/oss-security/2015/04/14/4
## http://www.halfdog.net/Security/2015/ApportKernelCrashdumpFileAccessVulnerabilities/
## https://wiki.ubuntu.com/Apport#Why_is_it_disabled.3F
## https://access.redhat.com/solutions/61536
harden_linux_disable_bugreport: true

_ubuntu_sysctl:

## maybe override in vars/{{ distribution }}*.yml
harden_debian_pkg:
#    - harden       ## exist in precise/trusty/vivid, not wily
    - unzip
    - rkhunter
    - chkrootkit
    - openntpd
    - acct
    - aide
    - logcheck
    - syslog-summary
    - apparmor-profiles
    - apparmor-utils
    - acl
    - sysstat
    - sysdig
    - tcpdump
    - libcap2-bin
    - ldnsutils
    - unattended-upgrades
    - update-notifier-common
    - gnupg
    - libpam-cracklib
    - debsums
    - apt-show-versions
    - arpwatch
    - lynis
    - libpam-tmpdir
    - debian-goodies
    - debsecan
    - fail2ban
## requested by https://github.com/awailly/cis-ubuntu-ansible
    - aptitude

harden_debian_remove:
    - avahi-daemon
    - xinetd
    - inetd
    - telnet-server
    - rsh-server

## maybe override in vars/{{ distribution }}*.yml and disabled on lxc as parts are not permitted
harden_distribution_sysctl:

harden_mount_options:
    "/": "defaults"
    "/boot": "defaults,nosuid,nodev,noexec"
    "/home": "defaults,nosuid,nodev"
    "/tmp": "defaults,nosuid,nodev,noexec"
    "/usr": "defaults,ro"
    "/var/log": "defaults,nosuid,nodev,noexec"
    "/var/tmp": "defaults,nosuid,nodev,noexec"
    "/var": "defaults,nosuid"

harden_mount_options_aptpre:
    "/tmp": "exec"
    "/var/tmp": "exec"
    "/usr": "rw"

harden_mount_options_aptpost:
    "/tmp": "noexec"
    "/var/tmp": "noexec"
    "/usr": "ro"

